<!DOCTYPE html>
<html lang="en-us">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Hunting for Impacket&#39;s Remote Code Execution Tools - misthi0s.dev</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/">
  <meta property="og:site_name" content="misthi0s.dev">
  <meta property="og:title" content="Hunting for Impacket&#39;s Remote Code Execution Tools">
  <meta property="og:description" content="Impacket is an open-source collection of Python libraries that can be used to construct and manipulate network protocols. At its core, it provides low-level programmatic access to packets and, in some cases, complete protocol implementations. The GitHub repository for Impacket can be found here.
Within the repository, Impacket contains a number of example scripts on how its modules can be utilized. These scripts show just how powerful Impacket can be in an offensive context; there are example scripts that allow for such things as performing a Kerberoasting or DCSync attack, relaying NTLM credentials, and generating Kerberos tickets. It also includes scripts to remotely execute commands on a system via a number of different protocols.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-08T16:20:00+00:00">
    <meta property="article:modified_time" content="2023-03-08T16:20:00+00:00">
    <meta property="article:tag" content="Detections">
    <meta property="article:tag" content="Impacket">
    <meta property="article:tag" content="Smb">
    <meta property="article:tag" content="Wmi">
    <meta property="article:tag" content="Dcom">
    <meta property="article:tag" content="Rce">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hunting for Impacket&#39;s Remote Code Execution Tools">
  <meta name="twitter:description" content="Impacket is an open-source collection of Python libraries that can be used to construct and manipulate network protocols. At its core, it provides low-level programmatic access to packets and, in some cases, complete protocol implementations. The GitHub repository for Impacket can be found here.
Within the repository, Impacket contains a number of example scripts on how its modules can be utilized. These scripts show just how powerful Impacket can be in an offensive context; there are example scripts that allow for such things as performing a Kerberoasting or DCSync attack, relaying NTLM credentials, and generating Kerberos tickets. It also includes scripts to remotely execute commands on a system via a number of different protocols.">
      <meta name="twitter:site" content="@_misthi0s">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" /><link rel="prev" href="http://localhost:1313/posts/2023-02-08-from-bat-to-asyncrat/" /><link rel="next" href="http://localhost:1313/posts/2024-05-12-powershell-reflective-dll-injection-sample-1/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Hunting for Impacket's Remote Code Execution Tools",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/2023-03-08-hunting-impacket-rce-tools\/"
        },"genre": "posts","keywords": "detections, impacket, smb, wmi, dcom, rce","wordcount":  1612 ,
        "url": "http:\/\/localhost:1313\/posts\/2023-03-08-hunting-impacket-rce-tools\/","datePublished": "2023-03-08T16:20:00+00:00","dateModified": "2023-03-08T16:20:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "misthi0s"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="misthi0s.dev">misthi0s.dev</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Blog </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/projects/"> Projects </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="misthi0s.dev">misthi0s.dev</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/">Blog</a><a class="menu-item" href="/categories/">Categories</a><a class="menu-item" href="/tags/">Tags</a><a class="menu-item" href="/projects/">Projects</a><a class="menu-item" href="/about/">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>Switch Theme</a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><div class="single-card"><h1 class="single-title animate__animated animate__flipInX">Hunting for Impacket's Remote Code Execution Tools</h1><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>misthi0s</a></span><span class="post-category">included in <a href="/categories/detections/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Detections</a></span></div>
                <div class="post-meta-line"><span class="post-publish">
                            <i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i><time datetime="2023-03-08">2023-03-08</time>
                        </span><span class="post-word-count">
                            <i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>1612 words
                        </span><span class="post-reading-time">
                            <i class="far fa-clock fa-fw" aria-hidden="true"></i>8 minutes
                        </span></div>
            </div><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>Contents</span>
                        <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#smbexec">SMBExec</a>
      <ul>
        <li><a href="#smbexec-detection">SMBExec Detection</a></li>
      </ul>
    </li>
    <li><a href="#wmiexec">WMIExec</a>
      <ul>
        <li><a href="#wmiexec-detection">WMIExec Detection</a></li>
      </ul>
    </li>
    <li><a href="#dcomexec">DCOMExec</a>
      <ul>
        <li><a href="#dcomexec-detection">DCOMExec Detection</a></li>
      </ul>
    </li>
    <li><a href="#final-thoughts">Final Thoughts</a></li>
    <li><a href="#detections-summary">Detections Summary</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><p>Impacket is an open-source collection of Python libraries that can be used to construct and manipulate network protocols. At its core, it provides low-level programmatic access to packets and, in some cases, complete protocol implementations. The GitHub repository for Impacket can be found <a href="https://github.com/fortra/impacket" target="_blank" rel="noopener noreferrer ">here</a>.</p>
<p>Within the repository, Impacket contains a number of example scripts on how its modules can be utilized. These scripts show just how powerful Impacket can be in an offensive context; there are example scripts that allow for such things as performing a <a href="https://github.com/fortra/impacket/blob/master/examples/GetUserSPNs.py" target="_blank" rel="noopener noreferrer ">Kerberoasting</a> or <a href="https://github.com/fortra/impacket/blob/master/examples/secretsdump.py" target="_blank" rel="noopener noreferrer ">DCSync</a> attack, <a href="https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py" target="_blank" rel="noopener noreferrer ">relaying NTLM credentials</a>, and generating <a href="https://github.com/fortra/impacket/blob/master/examples/getTGT.py" target="_blank" rel="noopener noreferrer ">Kerberos tickets</a>. It also includes scripts to remotely execute commands on a system via a number of different protocols.</p>
<h2 id="smbexec">SMBExec</h2>
<p>smbexec.py is an Impacket script that allows for the execution of commands against a remote system via SMB. SMBExec works by creating a temporary service on the target machine with a specially crafted command set as the service execution. This service command contains the following properties:
- The command to be executed, <code>echo</code>&lsquo;ed into a bat file
- <code>stdout</code> and <code>stderr</code> outputs redirected to a temporary output file
- The execution of the bat file containing the command to run
- The deletion of the bat file
Once the above service command is run, the Python script pulls the output file via SMB and displays the results in the SMBExec shell. The service is then deleted, and the entire process is re-run whenever another command is executed via SMBExec.</p>
<p>Below is an example of the SMBExec shell executing a <code>whoami</code> command on a remote system:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png"
        data-srcset="/images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png, /images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png 1.5x, /images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png 2x"
        data-sizes="auto"
        alt="/images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png"
        title="/images/277a68ce12fb4ec727ec2ff7e8aa085ba704357b.png" /></p>
<p>Below is a Sysmon <code>Process Create</code> event for the execution of the commandline specified within the service created:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png"
        data-srcset="/images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png, /images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png 1.5x, /images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png 2x"
        data-sizes="auto"
        alt="/images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png"
        title="/images/a34c492ca3e9cf57410dfef52600b5dc3d774481.png" /></p>
<h3 id="smbexec-detection">SMBExec Detection</h3>
<p>Let&rsquo;s take a look at the SMBExec source code from the GitHub repository. Near the beginning, we can see the following hardcoded variables:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">OUTPUT_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;__output&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">SMBSERVER_DIR</span>   <span class="o">=</span> <span class="s1">&#39;__tmp&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">DUMMY_SHARE</span>     <span class="o">=</span> <span class="s1">&#39;TMP&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">SERVICE_NAME</span>    <span class="o">=</span> <span class="s1">&#39;BTOBTO&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">CODEC</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">encoding</span></span></span></code></pre></div></div>
<p>In the Sysmon log, we can see the <code>OUTPUT_FILENAME</code> value in the commandline shortly after the <code>whoami</code> command specified, following the format: <code>\\127.0.0.1\C$\__output</code>. We also can see that the service name being created is set to <code>BTOBTO</code>, based on the variable name.</p>
<p>Back in the source code, we can see where this OUTPUT_FILENAME is being crafted in the <code>RemoteShell</code> class:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">share</span><span class="p">,</span> <span class="n">rpc</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">serviceName</span><span class="p">,</span> <span class="n">shell_type</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span><span class="o">.</span><span class="n">Cmd</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__share</span> <span class="o">=</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__mode</span> <span class="o">=</span> <span class="n">mode</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__output</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">127.0.0.1</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__share</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">OUTPUT_FILENAME</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__outputBuffer</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__command</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell</span> <span class="o">=</span> <span class="s1">&#39;%COMSPEC% /Q /c &#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell_type</span> <span class="o">=</span> <span class="n">shell_type</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__pwsh</span> <span class="o">=</span> <span class="s1">&#39;powershell.exe -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc &#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__serviceName</span> <span class="o">=</span> <span class="n">serviceName</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__rpc</span> <span class="o">=</span> <span class="n">rpc</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">intro</span> <span class="o">=</span> <span class="s1">&#39;[!] Launching semi-interactive shell - Careful what you execute&#39;</span></span></span></code></pre></div></div>
<p>We can also see from this that SMBExec supports executing commands via either <code>cmd.exe</code> (which is the value of the <code>%COMSPEC%</code> environment variable on Windows systems) or <code>powershell.exe</code>.</p>
<p>Looking further into the code, we can see where all the different variables (output filename, command to execute, etc) are combined to make the full commandline value we saw in the Sysmon log:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__shell</span> <span class="o">+</span> <span class="s1">&#39;echo &#39;</span> <span class="o">+</span> <span class="n">data</span> <span class="o">+</span> <span class="s1">&#39; ^&gt; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output</span> <span class="o">+</span> <span class="s1">&#39; 2^&gt;^&amp;1 &gt; &#39;</span> <span class="o">+</span> <span class="n">batchFile</span> <span class="o">+</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell</span> <span class="o">+</span> <span class="n">batchFile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mode</span> <span class="o">==</span> <span class="s1">&#39;SERVER&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copyBack</span>
</span></span><span class="line"><span class="cl"><span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; &amp; &#39;</span> <span class="o">+</span> <span class="s1">&#39;del &#39;</span> <span class="o">+</span> <span class="n">batchFile</span></span></span></code></pre></div></div>
<p>We can use all of the above information to craft detections for potential SMBExec execution within an environment. The best way to do this would be to use specially crafted RegEx strings against the <code>CommandLine</code> value found in the log.</p>
<p>Since we know the <code>OUTPUT_FILENAME</code> portion will always be <code>__output</code>, based on the hardcoded variable, we can use that to key off of. Likewise, we can see that the redirect string <code>2^&gt;^&amp;1 &gt;</code> is hardcoded when creating the command, which can also be used in the detection. With this in mind, we can create the following RegEx to match on an SMBExec-formatted string in a <code>CommandLine</code>, regardless of what command was executed:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-RegEx">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\\__output\s2\^&gt;\^&amp;1</span></span></code></pre></div></div>
<h2 id="wmiexec">WMIExec</h2>
<p>wmiexec.py is another Impacket script used to execute commands on a remote system using WMI. Unlike SMBExec, WMIExec does not require the creation of a service to execute commands, instead relying on DCOM and WMI providers to do so.</p>
<p>Below is an example of a WMIExec shell executing a <code>whoami</code> command on a remote system:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/4726dbed86c4f5c34850c557f2985195959c5d44.png"
        data-srcset="/images/4726dbed86c4f5c34850c557f2985195959c5d44.png, /images/4726dbed86c4f5c34850c557f2985195959c5d44.png 1.5x, /images/4726dbed86c4f5c34850c557f2985195959c5d44.png 2x"
        data-sizes="auto"
        alt="/images/4726dbed86c4f5c34850c557f2985195959c5d44.png"
        title="/images/4726dbed86c4f5c34850c557f2985195959c5d44.png" /></p>
<p>Below is a Sysmon <code>Process Create</code> event for the above execution, outlining the commandline and parent process used:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png"
        data-srcset="/images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png, /images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png 1.5x, /images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png 2x"
        data-sizes="auto"
        alt="/images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png"
        title="/images/d5ad599c996e568d86473fda1c62c2037c8b1f43.png" /></p>
<h3 id="wmiexec-detection">WMIExec Detection</h3>
<p>Let&rsquo;s take a look at the WMIExec source code. Like SMBExec, there is a hardcoded <code>OUTPUT_FILENAME</code> variable as follows:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">OUTPUT_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;__&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span></span></span></code></pre></div></div>
<p>Unlike SMBExec, this variable is not a hardcoded string, but instead created using Python&rsquo;s <code>time</code> module. According to <a href="https://docs.python.org/3/library/time.html#time.time" target="_blank" rel="noopener noreferrer ">Python&rsquo;s documentation</a>, <code>time.time()</code> returns the current &ldquo;time in seconds since the epoch as a floating point number.&rdquo; Basically, it returns what is commonly known as Unix time. This Unix time value is then appended to a <code>__</code> string and used as the <code>OUTPUT_FILENAME</code> variable in the script. In our test execution, this translated to <code>1677980195.873835</code>.</p>
<p>WMIExec includes a <code>RemoteShell</code> class very similar to SMBExec, as seen in the following:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">share</span><span class="p">,</span> <span class="n">win32Process</span><span class="p">,</span> <span class="n">smbConnection</span><span class="p">,</span> <span class="n">shell_type</span><span class="p">,</span> <span class="n">silentCommand</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span><span class="o">.</span><span class="n">Cmd</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__share</span> <span class="o">=</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__output</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">OUTPUT_FILENAME</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__outputBuffer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell</span> <span class="o">=</span> <span class="s1">&#39;cmd.exe /Q /c &#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell_type</span> <span class="o">=</span> <span class="n">shell_type</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__pwsh</span> <span class="o">=</span> <span class="s1">&#39;powershell.exe -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc &#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__win32Process</span> <span class="o">=</span> <span class="n">win32Process</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__transferClient</span> <span class="o">=</span> <span class="n">smbConnection</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__silentCommand</span> <span class="o">=</span> <span class="n">silentCommand</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__pwd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__noOutput</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">intro</span> <span class="o">=</span> <span class="s1">&#39;[!] Launching semi-interactive shell - Careful what you execute</span><span class="se">\n</span><span class="s1">[!] Press help for extra shell commands&#39;</span></span></span></code></pre></div></div>
<p>Just like SMBExec, we can see that these commands can be executed via either <code>cmd.exe</code> or <code>powershell.exe</code>.</p>
<p>We can also see in the source code where all of these factors are combined into the full commandline, giving us the structure the code uses for each command passed:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; 1&gt; &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">127.0.0.1</span><span class="se">\\</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__share</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output</span> <span class="o">+</span> <span class="s1">&#39; 2&gt;&amp;1&#39;</span></span></span></code></pre></div></div>
<p>Since the <code>time.time()</code> module follows a specific structure, we can use RegEx formatting to account for the variability in the <code>OUTPUT_FILENAME</code> variable for this script. This, combined with the hardcoded redirect <code>2&gt;&amp;1</code> allows us to craft a RegEx to find a potential WMIExec execution via a <code>CommandLine</code> query:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-RegEx">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\\__[0-9]{10}\.[0-9]{6,7}\s2&gt;&amp;1</span></span></code></pre></div></div>
<h2 id="dcomexec">DCOMExec</h2>
<p>dcomexec.py is yet another Impacket script that can be used to execute remote commands against a system, using DCOM endpoints. However, unlike WMIExec which uses a specific DCOM endpoint, DCOMExec allows for using a number of different DCOM endpoints. At the time of this writing, DCOMExec supports the following DCOM endpoints:</p>
<ul>
<li>MMC20.Application (49B2791A-B1AE-4C90-9B8E-E860BA07F889)</li>
<li>ShellWindows (9BA05972-F6A8-11CF-A442-00A0C90A8F39)</li>
<li>ShellBrowserWindow (C08AFD90-F2A1-11D1-8455-00A0C91F3880)</li>
</ul>
<p>Below is an example of the DCOMExec shell executing a <code>whoami</code> command on a remote system, using the MMC20 DCOM endpoint:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/69dc2a256c15e80a84693f26197ce989dd58045c.png"
        data-srcset="/images/69dc2a256c15e80a84693f26197ce989dd58045c.png, /images/69dc2a256c15e80a84693f26197ce989dd58045c.png 1.5x, /images/69dc2a256c15e80a84693f26197ce989dd58045c.png 2x"
        data-sizes="auto"
        alt="/images/69dc2a256c15e80a84693f26197ce989dd58045c.png"
        title="/images/69dc2a256c15e80a84693f26197ce989dd58045c.png" /></p>
<p>Below is the associated Sysmon <code>Process Create</code> event for the above behavior; note that the parent process is <code>mmc.exe</code> due to the fact the <code>MMC20</code> DCOM endpoint was used:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/6b7d82652d06b096baf3d5831322c923746caa32.png"
        data-srcset="/images/6b7d82652d06b096baf3d5831322c923746caa32.png, /images/6b7d82652d06b096baf3d5831322c923746caa32.png 1.5x, /images/6b7d82652d06b096baf3d5831322c923746caa32.png 2x"
        data-sizes="auto"
        alt="/images/6b7d82652d06b096baf3d5831322c923746caa32.png"
        title="/images/6b7d82652d06b096baf3d5831322c923746caa32.png" /></p>
<h3 id="dcomexec-detection">DCOMExec Detection</h3>
<p>Looking at the source code for DCOMExec, we can see that the <code>OUTPUT_FILENAME</code> variable is very similar to WMIExec, with one important distinction; rather than using the entire results of <code>time.time()</code>, only the first five numbers are returned. The code can be seen here:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">OUTPUT_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;__&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())[:</span><span class="mi">5</span><span class="p">]</span></span></span></code></pre></div></div>
<p>These five digits are then appended to the <code>__</code> string, similarly to WMIExec. In our test execution, this translated to <code>__16779</code>.</p>
<p>Below is DCOMExec&rsquo;s <code>RemoteShell</code> class, again very similar to WMIExec&rsquo;s class, and shows that this script can also execute commands via <code>cmd.exe</code> or <code>powershell.exe</code>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">share</span><span class="p">,</span> <span class="n">quit</span><span class="p">,</span> <span class="n">executeShellCommand</span><span class="p">,</span> <span class="n">smbConnection</span><span class="p">,</span> <span class="n">shell_type</span><span class="p">,</span> <span class="n">silentCommand</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span><span class="o">.</span><span class="n">Cmd</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_share</span> <span class="o">=</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">OUTPUT_FILENAME</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__outputBuffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_shell</span> <span class="o">=</span> <span class="s1">&#39;cmd.exe&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__shell_type</span> <span class="o">=</span> <span class="n">shell_type</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__pwsh</span> <span class="o">=</span> <span class="s1">&#39;powershell.exe -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc &#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__quit</span> <span class="o">=</span> <span class="n">quit</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_executeShellCommand</span> <span class="o">=</span> <span class="n">executeShellCommand</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">__transferClient</span> <span class="o">=</span> <span class="n">smbConnection</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_silentCommand</span> <span class="o">=</span> <span class="n">silentCommand</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_pwd</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">windows</span><span class="se">\\</span><span class="s1">system32&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">_noOutput</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">intro</span> <span class="o">=</span> <span class="s1">&#39;[!] Launching semi-interactive shell - Careful what you execute</span><span class="se">\n</span><span class="s1">[!] Press help for extra shell commands&#39;</span></span></span></code></pre></div></div>
<p>Finally, we can also see a similar looking <code>command</code> variable that concatenates all of the specified options into the full commandline string to be used:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; 1&gt; &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">127.0.0.1</span><span class="se">\\</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_share</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span> <span class="o">+</span> <span class="s1">&#39; 2&gt;&amp;1&#39;</span></span></span></code></pre></div></div>
<p>Since the commandlines between DCOMExec and WMIExec are the same with the exception of the length of the <code>time.time()</code> string, we can use a RegEx similar to the one for WMIExec, just with a slightly different matching format for the digit string:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-RegEx">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\\__[0-9]{5}\s2&gt;&amp;1</span></span></code></pre></div></div>
<h2 id="final-thoughts">Final Thoughts</h2>
<p>It is important to remember that these RegEx strings provided will match on these Impacket scripts <em>in their default state.</em> Since these are simply variables in a script, they can be easily modified by a threat actor to be something completely different. That being said, a lot of the time threat actors, with the exception of the most sophisticated ones, tend to run these types of open source tools as is, making the detections still viable in most situations. Beyond the RegEx strings, the parent to child process chains can be a great way to detect the behavior of these scripts, as those will be much more difficult to modify. For instance, <code>wmiprvse.exe</code> (for WMIExec) or <code>mmc.exe</code> (For DCOMExec using the <code>MMC20.Application</code> endpoint) spawning a <code>cmd.exe</code> or <code>powershell.exe</code> process could be considered suspicious and can make for great detections. Parent processes for the DCOMExec script, however, will be variable depending on which DCOM endpoint is chosen, so that needs to be taken into consideration as well.</p>
<h2 id="detections-summary">Detections Summary</h2>
<p>The following are potential detection capabilities for these Impacket scripts:</p>
<ul>
<li><code>cmd.exe</code> or <code>powershell.exe</code> commandline strings matching the following RegEx patterns:
<ul>
<li>SMBExec: <code>\\__output\s2\^&gt;\^&amp;1</code></li>
<li>WMIExec: <code>\\__[0-9]{10}\.[0-9]{6,7}\s2&gt;&amp;1</code></li>
<li>DCOMExec: <code>\\__[0-9]{5}\s2&gt;&amp;1</code></li>
</ul>
</li>
<li>Abnormal parent to child process chains, such as <code>mmc.exe</code> or <code>wmiprvse.exe</code> spawning <code>cmd.exe</code> or <code>powershell.exe</code>.</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-03-08</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools" data-via="_misthi0s" data-hashtags="detections,impacket,smb,wmi,dcom,rce"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-hashtag="detections"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/posts/2023-03-08-hunting-impacket-rce-tools/" data-title="Hunting for Impacket&#39;s Remote Code Execution Tools" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023-03-08-hunting-impacket-rce-tools%2f&amp;text=Hunting%20for%20Impacket%27s%20Remote%20Code%20Execution%20Tools" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i><a href="/tags/detections/">Detections</a>, <a href="/tags/impacket/">Impacket</a>, <a href="/tags/smb/">Smb</a>, <a href="/tags/wmi/">Wmi</a>, <a href="/tags/dcom/">Dcom</a>, <a href="/tags/rce/">Rce</a></section>
        <section class="post-back">
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2023-02-08-from-bat-to-asyncrat/" class="prev" rel="prev" title="From BAT to AsyncRAT"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>From BAT to AsyncRAT</a>
            <a href="/posts/2024-05-12-powershell-reflective-dll-injection-sample-1/" class="next" rel="next" title="Deep Analysis of a Powershell-Based Reflective DLL Injection Sample, Part 1">Deep Analysis of a Powershell-Based Reflective DLL Injection Sample, Part 1<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.148.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreferrer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{}};</script><script src="/js/theme.min.js"></script></body>
</html>
